<!DOCTYPE html>
<html>
<head>
    <title>Horseback Wizardry</title> 
    <script type="text/javascript" src="cocos2d-js-v3.9-lite.js" charset="UTF-8"></script>
	<style>
	body {
		background-color: blue;
	}
	canvas {
		border: 5px solid red;
	}
	</style>
</head>
<body>   
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <script type="text/javascript">
          window.onload = function(){
              cc.game.onStart = function(){
                  //load resources
                  cc.LoaderScene.preload(["HelloWorld.png"], function () {
                      var MenuScene = cc.Scene.extend({
                          onEnter:function () {
                              this._super();
                              var size = cc.director.getWinSize();
							  
							  var sprite = cc.Sprite.create("HelloWorld.png");
                              sprite.setPosition(size.width / 2, size.height / 2);
                              sprite.setScale(0.8);
                              this.addChild(sprite, 0);
							  
							  var menu = new cc.Menu();
							  menu.setPosition(size.width / 2, size.height / 2);
							  this.addChild(menu);

							  var playItem = new cc.MenuItemFont("Play Game", function(sender) {
								cc.log("Play Tapped");
								cc.log("play effect");
								cc.audioEngine.playEffect("Blip_Select.wav");
								cc.director.runScene(new GameplayScene());
							  }, this);
							  playItem.fontSize = 20;
							  playItem.fontName = "Arial";
							  menu.addChild(playItem);
							  
                              var label = cc.LabelTTF.create("Goodbye World", "Arial", 40);
                              label.setPosition(size.width / 2, size.height / 3);
                              this.addChild(label, 1);
                          }
                      });
					  var GameplayScene=cc.Scene.extend({
						score:0,
						
						scoreLabel:null,
						
						onEnter:function () {
                              this._super();
                              var size = cc.director.getWinSize();
							  
							  var menu = new cc.Menu();
							  //menu.setPosition(size.width / 2, size.height / 2);
							  this.addChild(menu);
							  
							  //Die
							  var dieItem = new cc.MenuItemFont("Die", function(sender) {
								cc.log("Die Tapped");
								var gameOverScene = new GameOverScene();
								gameOverScene.score = this.score;
								cc.director.runScene(gameOverScene);
							  }, this);
							  dieItem.color = cc.color(0,0,0);
							  dieItem.fontSize = 20;
							  dieItem.fontName = "Arial";
							  dieItem.setPosition(0, size.height / 3);
							  menu.addChild(dieItem);
							  
							  //The Player Node
							  var player = new cc.Sprite("spr_enemy_0.png");
							  //player.setContentSize(100,150);
							  player.setPosition(size.width / 2, size.height / 5);
							  //player.setAnchorPoint(cc.p(0.5,0));
							  //Adding a player to the scene.
							  this.addChild(player);
							  
							  
							  //The Magical Artifact
							  var orb = new cc.LayerColor(cc.color(90,90,90));
							  orb.setContentSize(100,100);
							  orb.setPosition(size.width / 2, size.height/2);
							  orb.setAnchorPoint(cc.p(.5, .5));
							  this.addChild(orb);
							  
							  cc.eventManager.addListener({
								event: cc.EventListener.TOUCH_ONE_BY_ONE,
								swallowTouches: true,
								onTouchEnded: function (touch, event) {
									var target = event.getCurrentTarget();
									cc.log(target);
									cc.log("Blah");
								}
							  }, orb);
							  
							  
							  
							  //Increase the score
							  var plusItem = new cc.MenuItemFont("Increase Score", function(sender) {
								cc.log("Plus Tapped");
								this.score++;
								this.scoreLabel.setString("Score: " + this.score);
							  }, this);
							  plusItem.color = cc.color(155,0,0);
							  plusItem.fontSize = 20;
							  plusItem.fontName = "Arial";
							  plusItem.setPosition(0, size.height / 4);
							  menu.addChild(plusItem);
							  
							  
                              this.scoreLabel = cc.LabelTTF.create("Score: " + this.score, "Arial", 40);
                              this.scoreLabel.setPosition(size.width / 2, size.height * .95 );
							  this.scoreLabel.color = cc.color(0,155,0);
                              this.addChild(this.scoreLabel);
						}
					  });
					var GameOverScene=cc.Scene.extend({
						
						score: 0,
						
						onEnter:function () {
                            this._super();
							
                            var size = cc.director.getWinSize();
							
							var menu = new cc.Menu();
							//menu.setPosition(size.width / 2, size.height / 2);
							this.addChild(menu);
							
							//Restart the game
							var retryItem = new cc.MenuItemFont("Restart Game", function(sender) {
								cc.log("Retry Tapped");
								cc.director.runScene(new GameplayScene());
							}, this);
							retryItem.color = cc.color(0,155,0);
							retryItem.fontSize = 20;
							retryItem.fontName = "Arial";
							retryItem.setPosition(0, size.height / 3);
							menu.addChild(retryItem);
						
							//Go back to the main menu
							var quitItem = new cc.MenuItemFont("Quit", function(sender) {
								cc.log("Quit Tapped");
								cc.director.runScene(new MenuScene());
							}, this);
							quitItem.color = cc.color(155,0,0);
							quitItem.fontSize = 20;
							quitItem.fontName = "Arial";
							quitItem.setPosition(0, size.height / 4);
							menu.addChild(quitItem);
							
							var scoreLabel = cc.LabelTTF.create("Score: " + this.score, "Arial", 40);
                            scoreLabel.setPosition(size.width / 2, size.height / 2);
							scoreLabel.color = cc.color(0,155,0);
                            this.addChild(scoreLabel);
						}
					  });
                      cc.director.runScene(new MenuScene());
                  }, this);
              };
              cc.game.run("gameCanvas");
          };
    </script>
</body>
</html>